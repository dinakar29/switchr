% \VignettePackage{switchr}
% \VignetteIndexEntry{switchr basics}
% \VignetteEngine{knitr::rmarkdown}

# The switchr package

## Managing and populating package libraries


Different versions of R packages are appropriate for different applications,
including package development, solo analysis, and
collaboration. *switchr* provides a framework for creating, populating,
managing, and switching between multiple package libraries from within
an R session.

```{r echo=FALSE, results="hide"}
library(switchr)
switchrBaseDir(file.path(tempdir(), ".switchr"))
switchrDontUnload(c("knitr", "evaluate", "digest", "formatR", "highr", 
                    "markdown", "stringr"))
options(width=40)

```


We create and use switchr package libraries by referring to them by
name using the /switchTo()/ function as seen below.

```{r}
switchTo("vign1")
```

The first time this code is run a "vign1" library is created and activated. By
activate we mean that it replaces the current User- and (by default) Site- 
library locations which R uses to find packages during the loading process.

To stop using "vign1" we simply call /switchBack()/:

```{r}
switchBack()
```


## Representing package cohorts

Empty package libraries are, of course, of limited use. The other main 
functionality *switchr* offers is installation of packages from a wide
variety of sources (git, svn, package repositories, and the CRAN Archive
among them), both individually and as cohorts.

We do this via a generalized form of a package repository called a 
/package manifest/, which includes a listing of packages and the information
switchr needs to install them (primarily location of their source code).

We can create a package manifest from scratch via the PkgManifest, though there
convenience functions for common use-cases such as Github packages

```{r}
man = PkgManifest(name = "fastdigest", 
    url = "https://github.com/gmbecker/fastdigest")
man
``` 

The `GithubManifest` convenience function builds manifests from GitHub username/repository
pairs for package sources residing in the root directory of the master branch for the 
specified repository.
```{r}
man2 = GithubManifest("gmbecker/fastdigest", 
     "gmbecker/RCacheSuite")
man2
```



## Representing and (re-)installing package cohorts/libraries

Beyond package manifests, *switchr* also supports /seeding manifests/, which
extend package manifests by indicating a subset of the packages listed in 
the manifest, specific package-version information, or both.

```{r}
lman = libManifest()
lman
```

Package or seeding manifests can then be used to /seed/ switchr libraries. 
During the new-library creation process, all packages listed in the seed
- typically a /seeding manifest/, /package manifest/, or specially-purposed
package repository - are installed. In the case that a /seeding manifest/ is
used, the exact, specified versions of the indicated packages are
retrieved and installed, while for a package manifest the latest versions
available are used.

We specify a seed via the /seed/ argument to the /switchTo/ function, like so:

NOT RUN
```{r eval=FALSE}
switchTo("vign2", seed = lman)
```

The above code will create a new switchr library called vign2 and populate it with
the package versions listed in lman - i.e., the packages installed in the library
used to build this vignette.


## Installing specific packages


*switchr* also provides the /install_packages/ function for installing specific packages
or sets of packages from a variety of sources, including traditional repositories
and package manifests. This function supports package dependencies, including 
non-repository to non-repository dependecies (e.g. between two or more packages
on GitHub) on systems able to build packages from source.



NOT RUN
```{r eval=FALSE}
install_packages("RCacheSuite", man2)
```